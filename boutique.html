<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arcade Master - Boutique</title>
    
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <style>
        /* Styles spÃ©cifiques Ã  la boutique */
        .shop-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            margin-top: 40px;
            padding: 0 20px;
        }
        .item-card {
            background-color: var(--color-card-dark);
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.1);
            text-align: center;
            padding: 20px;
            transition: transform 0.3s, border-color 0.3s;
            border: 3px solid transparent;
        }
        .item-card.owned {
            border-color: var(--color-neon-green);
        }
        .item-card.equipped {
            border-color: var(--color-neon-orange);
            box-shadow: 0 0 20px var(--color-neon-orange);
        }
        .item-card h3 {
            color: var(--color-neon-green);
            font-size: 2em;
            margin: 10px 0;
        }
        .item-card p {
            color: var(--color-text-light);
            margin-bottom: 15px;
        }
        .item-price {
            font-size: 1.5em;
            font-weight: bold;
            color: var(--color-neon-orange);
            margin-bottom: 20px;
            display: block;
        }
        .item-card button {
            padding: 10px 20px;
            font-size: 1.1em;
            min-width: 150px;
        }
        .item-card button.buy-btn {
            background-color: var(--color-neon-orange);
        }
        .item-card button.equip-btn {
            background-color: var(--color-neon-green);
        }
    </style>
</head>
<body>

    <div id="top-bar">
        <div id="menuToggle" class="menu-toggle">
            <i class="fa-solid fa-bars"></i>
        </div>
        <span style="font-size: 1.5em; font-weight: bold; color: var(--color-neon-orange);">
            ARCADE SHOP
        </span>
        <div id="right-container" style="display: flex; align-items: center; gap: 15px;">
        </div>
    </div>

    <div id="sidebar" class="sidenav">
        <a href="javascript:void(0)" class="closebtn" id="closeNav" onclick="closeNav()" style="position: absolute; top: 0; right: 25px; font-size: 36px; color: var(--color-neon-orange);">&times;</a>
        <div id="nav-links">
            <a href="index.html" data-emoji="ğŸ ">ğŸ  Accueil</a>
            <a href="jeux.html" data-emoji="ğŸ®">ğŸ® Menu Jeux</a>
            <a href="compte.html" data-emoji="ğŸ‘¤">ğŸ‘¤ Mon Compte</a>
            <a href="boutique.html" data-emoji="ğŸ›ï¸">ğŸ›ï¸ Boutique</a>
            <a href="classement.html" data-emoji="ğŸ†">ğŸ† Classement</a>
            <a href="credits.html" data-emoji="ğŸ“œ">ğŸ“œ CrÃ©dits</a>
        </div>
    </div>

    <div class="main-container" id="mainContent">
        <div style="padding-top: 50px;"></div> 
        
        <h1 style="font-size: 2.5em; color: var(--color-neon-orange);">BOUTIQUE DE COSMÃ‰TIQUES</h1>
        <p style="text-align: center; color: var(--color-text-light); margin-bottom: 30px;">
            DÃ©pensez vos piÃ¨ces durement gagnÃ©es pour personnaliser votre vaisseau !
        </p>

        <div class="shop-grid" id="shopGrid">
            <div class="item-card item-0 equipped" data-name="Vaisseau de base" data-emoji="ğŸš€" data-price="0">
                <h3>Vaisseau de base ğŸš€</h3>
                <p>Le vaisseau par dÃ©faut. Fiable et simple.</p>
                <span class="item-price">PossÃ©dÃ©</span>
                <button class="equip-btn">Ã‰QUIPÃ‰</button>
            </div>
            
            <div class="item-card item-1" data-name="Vaisseau Ã‰clair" data-emoji="ğŸ›¸" data-price="500">
                <h3>Vaisseau Ã‰clair ğŸ›¸</h3>
                <p>Un design furtif et rapide.</p>
                <span class="item-price">500 ğŸ’°</span>
                <button class="buy-btn" onclick="buyItem(1)">Acheter</button>
            </div>
            
            <div class="item-card item-2" data-name="Vaisseau NÃ©on" data-emoji="ğŸ‘½" data-price="1200">
                <h3>Vaisseau NÃ©on ğŸ‘½</h3>
                <p>Illuminez l'espace avec ce modÃ¨le unique.</p>
                <span class="item-price">1200 ğŸ’°</span>
                <button class="buy-btn" onclick="buyItem(2)">Acheter</button>
            </div>
            
            <div class="item-card item-3" data-name="Vaisseau Royal" data-emoji="ğŸ‘‘" data-price="5000">
                <h3>Vaisseau Royal ğŸ‘‘</h3>
                <p>RÃ©servÃ© Ã  l'Ã©lite.</p>
                <span class="item-price">5000 ğŸ’°</span>
                <button class="buy-btn" onclick="buyItem(3)">Acheter</button>
            </div>

            </div>
        
    </div>
    
    <script src="base.js"></script>
    <script src="auth.js"></script>
    <script>
        // Logique spÃ©cifique Ã  la boutique

        const SHOP_ITEMS = [
            { id: 0, name: "Vaisseau de base", emoji: 'ğŸš€', price: 0, type: 'ship' },
            { id: 1, name: "Vaisseau Ã‰clair", emoji: 'ğŸ›¸', price: 500, type: 'ship' },
            { id: 2, name: "Vaisseau NÃ©on", emoji: 'ğŸ‘½', price: 1200, type: 'ship' },
            { id: 3, name: "Vaisseau Royal", emoji: 'ğŸ‘‘', price: 5000, type: 'ship' },
        ];
        
        function updateShopDisplay() {
            const currentUser = getCurrentUser();
            if (!currentUser) {
                // Si non connectÃ©, n'affiche pas les boutons d'achat/Ã©quipement
                document.getElementById('shopGrid').querySelectorAll('button').forEach(btn => btn.disabled = true);
                return;
            }
            
            SHOP_ITEMS.forEach(item => {
                const card = document.querySelector(`.item-card.item-${item.id}`);
                if (!card) return;

                card.classList.remove('owned', 'equipped');
                const priceSpan = card.querySelector('.item-price');
                const button = card.querySelector('button');

                const isOwned = currentUser.skins && currentUser.skins.owned && currentUser.skins.owned.includes(item.id);
                const isEquipped = currentUser.skins && currentUser.skins.active && currentUser.skins.active.ship === item.emoji;

                if (isEquipped) {
                    card.classList.add('equipped');
                    priceSpan.textContent = 'Ã‰QUIPÃ‰';
                    button.textContent = 'Ã‰QUIPÃ‰';
                    button.disabled = true;
                    button.className = 'equip-btn';
                } else if (isOwned || item.id === 0) { // L'ID 0 est toujours possÃ©dÃ©
                    card.classList.add('owned');
                    priceSpan.textContent = 'PossÃ©dÃ©';
                    button.textContent = 'Ã‰quiper';
                    button.disabled = false;
                    button.className = 'equip-btn';
                    button.onclick = () => equipItem(item.id);
                } else {
                    priceSpan.innerHTML = `${item.price} ğŸ’°`;
                    button.textContent = 'Acheter';
                    button.disabled = false;
                    button.className = 'buy-btn';
                    button.onclick = () => buyItem(item.id);
                }
            });
        }
        
        window.buyItem = function(itemId) {
            const currentUser = getCurrentUser();
            if (!currentUser) {
                alert("Vous devez Ãªtre connectÃ© pour effectuer des achats !");
                return;
            }
            
            const item = SHOP_ITEMS.find(i => i.id === itemId);
            if (!item) return;

            if (currentUser.coins >= item.price) {
                // Achat rÃ©ussi
                currentUser.coins -= item.price;
                if (!currentUser.skins.owned) {
                    currentUser.skins.owned = [0]; // S'assurer que le 0 est lÃ 
                }
                if (!currentUser.skins.owned.includes(itemId)) {
                    currentUser.skins.owned.push(itemId);
                }
                
                updateGlobalUser(currentUser); 
                alert(`Achat rÃ©ussi : ${item.name} pour ${item.price} piÃ¨ces !`);
                updateShopDisplay();
            } else {
                alert(`Fonds insuffisants. Il vous manque ${item.price - currentUser.coins} piÃ¨ces.`);
            }
        }
        
        window.equipItem = function(itemId) {
            const currentUser = getCurrentUser();
            const item = SHOP_ITEMS.find(i => i.id === itemId);
            
            if (!currentUser || !item || item.type !== 'ship') return;
            
            // Ã‰quipement
            currentUser.skins.active.ship = item.emoji;
            updateGlobalUser(currentUser);
            alert(`${item.name} Ã©quipÃ© !`);
            updateShopDisplay();
        }

        document.addEventListener('DOMContentLoaded', updateShopDisplay);
    </script>
</body>
</html>
